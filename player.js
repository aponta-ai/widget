import{a as j,r as u,j as r,I as E,B as C,c as R}from"./main.js";const S={baseURL:"https://api.aponta.ai"},k=j.create(S),$={findOne:async t=>(await k.get("/api/guides/"+t)).data};async function B(t){await new Promise((e,o)=>{const s=new MutationObserver(()=>{document.querySelector(t)&&(s.disconnect(),e(null))});s.observe(document.body,{childList:!0,subtree:!0}),document.querySelector(t)&&(s.disconnect(),e(null))})}function T({text:t,element:e,leaveGuide:o,goToNextStep:s}){const h=u.useRef(null),[f,g]=u.useState({style:{},className:""});return u.useEffect(()=>{const n=h.current.getBoundingClientRect(),a={top:{style:{top:`-${n.height+20}`},className:"recording-steps-box-input-top"},bottom:{style:{bottom:`-${n.height+20}`},className:"recording-steps-box-input-bottom"},left:{style:{left:`-${n.width+10}`},className:"recording-steps-box-input-left"},right:{style:{right:`-${n.width+10}`},className:"recording-steps-box-input-right"},"top-left":{style:{top:`-${n.height+10}`,left:`-${n.width+10}`},className:"recording-steps-box-input-top-left"},"top-right":{style:{top:`-${n.height+10}`,right:`-${n.width+10}`},className:"recording-steps-box-input-top-right"},"bottom-left":{style:{bottom:`-${n.height+10}`,left:`-${n.width+10}`},className:"recording-steps-box-input-bottom-left"},"bottom-right":{style:{bottom:`-${n.height+10}`,right:`-${n.width+10}`},className:"recording-steps-box-input-bottom-right"}},w=Object.keys(a);let i=null;const{scrollY:l,scrollX:c}=window,d=e.getBoundingClientRect(),m=w.find(N=>{const{top:y,left:x,bottom:b,right:v}=a[N].style;return!(y&&l+d.top-Math.abs(y)<l||x&&c+d.left-Math.abs(x)<c||b&&d.bottom+Math.abs(b)>window.innerHeight||v&&d.right+Math.abs(v)>window.innerWidth)});m?i=a[m]:i=a.top,g({...i,style:{top:i.style.top?`${i.style.top}px`:"",left:i.style.left?`${i.style.left}px`:"",bottom:i.style.bottom?`${i.style.bottom}px`:"",right:i.style.right?`${i.style.right}px`:""}})},[]),r.jsxs("div",{ref:h,onClick:n=>{n.stopPropagation(),n.preventDefault()},className:"floating-informations "+f.className,style:{...f.style,pointerEvents:"all"},children:[r.jsx(E,{className:"mt-2 text-input-floating-informations",type:"textarea",value:t,disabled:!0,placeholder:"",style:{border:"none",fontSize:"17px",resize:"none"}}),r.jsxs("div",{className:"mt-2 d-flex justify-content-end gap-4 align-items-center",children:[r.jsx("span",{style:{fontSize:"14px",cursor:"pointer",color:"gray"},onClick:()=>{o&&o()},children:"Sair"}),r.jsx(C,{color:"primary",className:"px-2",style:{fontSize:"15px",lineHeight:"1"},onClick:()=>{s.current()},children:"Continuar"})]})]})}function L({borderInfo:t,goToNextStep:e,leaveGuide:o}){return t!=null&&t.show?r.jsx("div",{className:"animate-border position-absolute floating-border d-flex align-items-center justify-content-center",style:{...t,borderRadius:t.selected?"15px":" 0px 15px 15px 15px;",pointerEvents:"none",boxShadow:"0 0 0 99999px rgba(0, 0, 0, .4)",zIndex:1e3},children:r.jsx(T,{element:t.element,text:t.text,leaveGuide:o,goToNextStep:e})}):null}async function z(){let t=null;function e(o){t!==null&&clearTimeout(t),t=setTimeout(function(){window.removeEventListener("scroll",e,!1),o()},150)}return await new Promise(o=>{window.addEventListener("scroll",()=>e(o),!1);const s=window.scrollY;setTimeout(()=>{s===window.scrollY&&o(null)},150)})}const p=8;function F(){const[t,e]=u.useState({}),o=u.useRef(null),s=u.useRef(null);async function h(){const f=new URL(window.location.href).searchParams.get("live_playbook_id"),g=await $.findOne(f);async function n(a,w){const i=a.shift();if(!i)return;await B(i.selector);const l=document.querySelector(i.selector);let c=l.getBoundingClientRect();e({top:c.top-p+window.scrollY,left:c.left-p+window.scrollX,width:c.width+p*2,height:c.height+p*2,element:l,show:!0,text:i.description}),l.scrollIntoView({behavior:"smooth",block:"center"}),await z(),c=l.getBoundingClientRect(),e({top:c.top-p+window.scrollY,left:c.left-p+window.scrollX,width:c.width+p*2,height:c.height+p*2,element:l,show:!0,text:i.description});const d=async()=>{if(!((l.tagName==="INPUT"||l.tagName==="TEXTAREA")&&!w)){if(a.length===0)return e({...t,show:!1});n(a),l.removeEventListener("click",d)}};s.current=d,l.addEventListener("click",d),o.current=m=>{e({...t,show:!1}),n(a,m)}}n(g.steps)}return u.useEffect(()=>{h()},[]),r.jsx("div",{className:"apontai-container",children:r.jsx("div",{style:{width:"100%",position:"absolute",zIndex:"calc(infinity)",top:0,left:0,background:"red",display:"flex",justifyContent:"center",alignItems:"center"},children:r.jsx("div",{style:{visibility:"visible",height:"fit-content"},children:r.jsx(L,{leaveGuide:()=>{e({...t,show:!1}),t.element.removeEventListener("click",s.current)},goToNextStep:o,borderInfo:{...t}})})})})}async function I(){const t=document.createElement("div");t.id="container_widget",t.attachShadow({mode:"open"}),document.body.appendChild(t);const e=document.createElement("link");e.rel="stylesheet",e.href="https://app.aponta.ai/widget/player.css",t.shadowRoot.appendChild(e);const o=document.createElement("link");o.rel="stylesheet",o.href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css",t.shadowRoot.appendChild(o);const s=document.createElement("link");s.rel="stylesheet",s.href="http://fonts.googleapis.com/css?family=Roboto:400,100,300,100italic,300italic,400italic,500italic,500,700,700italic,900,900italic",t.shadowRoot.appendChild(s),R.createRoot(document.getElementById("container_widget").shadowRoot).render(r.jsx(F,{}))}I();
